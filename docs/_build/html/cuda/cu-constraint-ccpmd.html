<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Constant chemical potential &mdash; PYGAMD v1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=5cb08e4e"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bond constraint" href="cu-constraint-bond_constraint.html" />
    <link rel="prev" title="Remove CM momentum" href="cu-constraint-remove_momentum.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PYGAMD
          </a>
              <div class="version">
                v1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">Units</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules (NUMBA)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../numba/system.html">System info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numba/application.html">Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numba/forcefield.html">Force field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numba/integration.html">Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numba/module.html">Modules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules (CUDA)</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cu-data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="cu-system.html">System</a></li>
<li class="toctree-l1"><a class="reference internal" href="cu-application.html">Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="cu-forcefield.html">Force field</a></li>
<li class="toctree-l1"><a class="reference internal" href="cu-integration.html">Integration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="cu-constraint.html">Constraint</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cu-constraint-variant.html">Variant</a></li>
<li class="toctree-l2"><a class="reference internal" href="cu-constraint-space_constraint.html">Space constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="cu-constraint-remove_momentum.html">Remove CM momentum</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Constant chemical potential</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CCPMD"><code class="docutils literal notranslate"><span class="pre">CCPMD</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#CCPMD.setWall"><code class="docutils literal notranslate"><span class="pre">CCPMD.setWall()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#CCPMD.setParams"><code class="docutils literal notranslate"><span class="pre">CCPMD.setParams()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cu-constraint-bond_constraint.html">Bond constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="cu-constraint-virtual_site.html">Virtual site</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cu-externalfield.html">External field</a></li>
<li class="toctree-l1"><a class="reference internal" href="cu-module.html">Modules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plug-Ins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../molgen.html">molgen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataTackle.html">dataTackle</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Announcement</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PYGAMD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="cu-constraint.html">Constraint</a></li>
      <li class="breadcrumb-item active">Constant chemical potential</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cuda/cu-constraint-ccpmd.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="constant-chemical-potential">
<h1>Constant chemical potential<a class="headerlink" href="#constant-chemical-potential" title="Link to this heading">¶</a></h1>
<p>Constant Chemical Potential Molecular Dynamics (C <span class="math notranslate nohighlight">\(\mu\)</span> MD) method introduces an external force that controls the environment of the chemical process of interest.
This external force, drawing molecules from a finite reservoir, maintains the chemical potential constant in the region where the process takes place.
This method is able to study crystal growth dynamics under constant supersaturation conditions or evaporation dynamics under constant vapor pressure. Reference: C. Perego, M. Salvalaglio, and M. Parrinello, J. Chem. Phys., 2015, 142, 144113.</p>
<a class="reference internal image-reference" href="../_images/ccpmd.png"><img alt="Constant Chemical Potential Molecular Dynamics" class="align-center" src="../_images/ccpmd.png" style="width: 512px;" /></a>
<p>Description:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\begin{eqnarray*}
F^{\mathrm{\mu}}(z) &amp;=&amp; k(n^{CR}-n_{0})G(z, Z_{F}) \\
        G(z-Z_{F}) &amp;=&amp; \frac{1}{4\omega}\left[ 1+cosh \left(\frac{z-Z_{F}}{\omega} \right) \right]^{-1} \\
\end{eqnarray*}</div><p>Coefficients:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n_0\)</span> - target constant concentration <code class="docutils literal notranslate"><span class="pre">n0</span></code> (in reduced units)</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> - spring constant <code class="docutils literal notranslate"><span class="pre">k</span></code> (in units of energy/distance^2)</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span> - width of external force region <code class="docutils literal notranslate"><span class="pre">sigma</span></code> (in units of distance)</p></li>
<li><p><span class="math notranslate nohighlight">\(\omega\)</span> - an intensity peak proportional to <code class="docutils literal notranslate"><span class="pre">1/omega</span></code> and a width proportional to <code class="docutils literal notranslate"><span class="pre">omega</span></code> (in units of distance)</p></li>
</ul>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="CCPMD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CCPMD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CCPMD" title="Link to this definition">¶</a></dt>
<dd><p>The constructor of a constant chemical potential object of a group of particles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_info</strong> (<a class="reference internal" href="cu-system-information.html#AllInfo" title="AllInfo"><em>AllInfo</em></a>) – The system information.</p></li>
<li><p><strong>group</strong> (<a class="reference internal" href="cu-system-group.html#id2" title="ParticleSet"><em>ParticleSet</em></a>) – The group of particles.</p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="CCPMD.setWall">
<span class="sig-name descname"><span class="pre">setWall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">ox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">oy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">oz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">dz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CCPMD.setWall" title="Link to this definition">¶</a></dt>
<dd><p>specifies external force region with plane center (ox, oy, oz) and direction (dx, dy, dz). If the normal direction of wall is in Z direction, the center position of plane is (0.0, 0.0, <span class="math notranslate nohighlight">\(Z_{F}\)</span>).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CCPMD.setParams">
<span class="sig-name descname"><span class="pre">setParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">n0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">Len_CR</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CCPMD.setParams" title="Link to this definition">¶</a></dt>
<dd><p>specifies target concentration, spring constant, sigma, omega, and the length of control region.</p>
</dd></dl>

<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">groupS</span> <span class="o">=</span> <span class="n">gala</span><span class="o">.</span><span class="n">ParticleSet</span><span class="p">(</span><span class="n">all_info</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span>
<span class="n">ccp</span> <span class="o">=</span> <span class="n">gala</span><span class="o">.</span><span class="n">CCPMD</span><span class="p">(</span><span class="n">all_info</span><span class="p">,</span> <span class="n">groupS</span><span class="p">)</span>
<span class="n">ccp</span><span class="o">.</span><span class="n">setWall</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">ccp</span><span class="o">.</span><span class="n">setParams</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ccp</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cu-constraint-remove_momentum.html" class="btn btn-neutral float-left" title="Remove CM momentum" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cu-constraint-bond_constraint.html" class="btn btn-neutral float-right" title="Bond constraint" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2022, You-Liang Zhu and Zhong-Yuan Lu, ylzhu@pygamd.com.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>